// 内容创作平台数据库模型

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./data.db"
}

// AI配置
model AIConfig {
  id        String   @id @default("default")
  provider  String   @default("openai")
  apiKey    String?
  baseUrl   String   @default("https://api.openai.com/v1")
  model     String   @default("gpt-4o-mini")
  enabled   Boolean  @default(false)
  updatedAt DateTime @updatedAt
}

// 图片生成配置
model ImageConfig {
  id        String   @id @default("default")
  provider  String   @default("openai")
  apiKey    String?
  baseUrl   String   @default("https://api.openai.com/v1")
  model     String   @default("dall-e-3")
  enabled   Boolean  @default(false)
  updatedAt DateTime @updatedAt
}

// 社交媒体账号
model SocialAccount {
  id           String   @id @default(cuid())
  platform     String   // douyin, xiaohongshu, toutiao, weibo
  accountName  String
  accountId    String?  // 平台账号ID
  avatar       String?  // 头像URL
  fansCount    Int      @default(0)
  notesCount   Int      @default(0)
  accessToken  String?  // 授权token（如有）
  refreshToken String?
  status       String   @default("active") // active, expired, disconnected
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  contents     Content[]
}

// 内容
model Content {
  id          String   @id @default(cuid())
  title       String
  content     String   // 正文内容
  category    String   // food, pet
  platform    String   // 目标平台
  style       String?  // 写作风格
  type        String   // copywriting, script, article
  status      String   @default("draft") // draft, published
  tags        String?  // 标签，逗号分隔
  coverImage  String?  // 封面图
  
  // 发布数据
  likes       Int      @default(0)
  comments    Int      @default(0)
  shares      Int      @default(0)
  views       Int      @default(0)
  publishedAt DateTime?
  
  accountId   String?
  account     SocialAccount? @relation(fields: [accountId], references: [id])
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// 热门内容（从各平台抓取或用户添加）
model HotContent {
  id            String   @id @default(cuid())
  title         String
  content       String?  // 内容摘要
  platform      String   // 来源平台
  category      String   // food, pet, general
  author        String?  // 作者名称
  authorId      String?  // 作者ID
  authorAvatar  String?  // 作者头像
  coverImage    String?  // 封面图
  link          String?  // 原文链接
  
  // 数据指标
  likes         Int      @default(0)
  comments      Int      @default(0)
  shares        Int      @default(0)
  views         Int      @default(0)
  collects      Int      @default(0)  // 收藏数
  
  // AI分析结果
  analysis      String?  // AI分析内容特点
  keywords      String?  // 关键词，逗号分隔
  styleTags     String?  // 风格标签
  
  // 用户操作
  isFavorite    Boolean  @default(false)  // 是否收藏
  isAnalyzed    Boolean  @default(false)  // 是否已分析
  
  publishedAt   DateTime? // 发布时间
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

// 热榜记录
model HotRank {
  id          String   @id @default(cuid())
  platform    String   // weibo, douyin, xiaohongshu, toutiao
  keyword     String   // 热搜关键词
  rank        Int      // 排名
  heat        Int      @default(0) // 热度值
  category    String   @default("general") // food, pet, general
  link        String?  // 链接
  
  createdAt   DateTime @default(now())
}

// 用户设置
model UserSettings {
  id          String   @id @default("default")
  category    String   @default("food") // 当前选择的领域
  theme       String   @default("light")
  language    String   @default("zh-CN")
  updatedAt   DateTime @updatedAt
}
